<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>VoodOrm 2.x.x by mardix</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>VoodOrm 2.x.x</h1>
          <h2>VoodOrm: a fluent SQL query builder on top of PDO. It makes writing queries and CRUD painless. Works well with table relationships</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/mardix/VoodOrm/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/mardix/VoodOrm/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/mardix/VoodOrm" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a name="voodorm-2xx" class="anchor" href="#voodorm-2xx"><span class="octicon octicon-link"></span></a>VoodOrm 2.x.x</h1>

<h4>
<a name="a-simple-micro-orm-that-stays-out-of-your-way" class="anchor" href="#a-simple-micro-orm-that-stays-out-of-your-way"><span class="octicon octicon-link"></span></a>A simple micro-ORM that stays out of your way</h4>

<hr><p>Name: <a href="http://github.com/mardix/VoodOrm">VoodOrm</a></p>

<p>License: MIT</p>

<p>Author: <a href="http://github.com/mardix">Mardix</a></p>

<p>Version : 2.x.x</p>

<p>Requirements: PHP &gt;= 5.4, PDO</p>

<hr><h2>
<a name="about-voodoo" class="anchor" href="#about-voodoo"><span class="octicon octicon-link"></span></a>About Voodoo!</h2>

<p>VoodOrm is a micro-ORM which functions as both a fluent select query API and a CRUD model class.</p>

<p>VoodOrm is built on top of PDO and is well fit for small to mid-sized projects, where the emphasis 
is on simplicity and rapid development rather than infinite flexibility and features.
VoodOrm works easily with table relationship. And offers api that gets SQL out of your way</p>

<hr><h2>
<a name="features" class="anchor" href="#features"><span class="octicon octicon-link"></span></a>Features</h2>

<ul>
<li>PDO and prepared statements</li>
<li>Fluent Query</li>
<li>Relationship</li>
<li>Joins</li>
<li>Aggregation</li>
<li>Query debugger and query profiler</li>
<li>Active Record pattern</li>
</ul><h2>
<a name="requirements" class="anchor" href="#requirements"><span class="octicon octicon-link"></span></a>Requirements</h2>

<ul>
<li>PHP &gt;= 5.4</li>
<li>PDO</li>
</ul><h2>
<a name="error-reporting" class="anchor" href="#error-reporting"><span class="octicon octicon-link"></span></a>Error Reporting</h2>

<p>VoodOrm does not escalate errors. Non-existing table produces SQL error that is reported by PDO conforming to PDO::ATTR_ERRMODE. Non-existing columns produces the same E_NOTICE as an attempt to access non-existing key in array.</p>

<h2>
<a name="what-it-doesnt-do" class="anchor" href="#what-it-doesnt-do"><span class="octicon octicon-link"></span></a>What it doesn't do.</h2>

<p>We believe it's best if certain stuff is kept to the developer to do, like caching or data validation. Also data validation can be done at the database level.</p>

<ul>
<li>No models or entities generation</li>
<li>No data validation</li>
<li>No caching</li>
<li>No database migration</li>
</ul><h2>
<a name="install-voodorm" class="anchor" href="#install-voodorm"><span class="octicon octicon-link"></span></a>Install VoodOrm</h2>

<p>You can just download VoodOrm as is, or with Composer. </p>

<p>To install with composer, add the following in the require key in your <strong>composer.json</strong> file</p>

<pre><code>"voodoophp/voodorm": "2.*"
</code></pre>

<p>composer.json</p>

<pre><code>{
    "name": "voodoophp/myapp",
    "description": "My awesome Voodoo App",
    "require": {
        "voodoophp/voodorm": "2.*"
    }
}
</code></pre>

<hr><h2>
<a name="working-with-voodorm" class="anchor" href="#working-with-voodorm"><span class="octicon octicon-link"></span></a>Working with VoodOrm</h2>

<hr><h3>
<a name="new-voodorm-pdo-pdo-" class="anchor" href="#new-voodorm-pdo-pdo-"><span class="octicon octicon-link"></span></a><strong><em>new VoodOrm(</em></strong> <em>PDO $pdo</em> <strong><em>)</em></strong>
</h3>

<p>To get started with VoodOrm, you have to setup the PDO connection. We'll be using the variable $DB as the database connection, <code>$users</code> as the table, <code>$friends</code> as another table throughout this whole tutorial</p>

<pre><code>$pdo = new PDO("mysql:host=localhost;dbname=$dbname", $username, $password);
$pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$DB = new VoodOrm($pdo);
</code></pre>

<hr><h3>
<a name="voodorm-voodormtable-string-tablename-" class="anchor" href="#voodorm-voodormtable-string-tablename-"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::table(</em></strong> <em>string $tablename</em> <strong><em>)</em></strong>
</h3>

<p>To connect to a table is straight forward by calling the method <code>VoodOrm::table()</code> </p>

<pre><code>$users = $DB-&gt;table('users');
</code></pre>

<p>You can also set the table by calling the table as a method. The above can be also written like this</p>

<pre><code>$users = $DB-&gt;users();
$friends = $DB-&gt;friends();
</code></pre>

<p>From there you will be able able to do any CRUD on the table with VoodOrm fluent query interface</p>

<hr><h2>
<a name="data-modification" class="anchor" href="#data-modification"><span class="octicon octicon-link"></span></a>Data Modification</h2>

<p>VoodOrm supports data modification (insert, update and delete). No data validation is performed by VoodOrm but all database errors are reported by the standard PDO error reporting. For data validation, we believe it's best to validate your data at the database level or application level</p>

<hr><h3>
<a name="mixed-voodorminsert-array-data-" class="anchor" href="#mixed-voodorminsert-array-data-"><span class="octicon octicon-link"></span></a><em>mixed</em> <strong><em>VoodOrm::insert(</em></strong> <em>Array $data</em> <strong><em>)</em></strong>
</h3>

<p>To insert data in the table, use the <code>insert(Array $data)</code> where <code>$data</code> can be a one dimentional array to insert  just one entry, or a muliple arrays to do mass insert. </p>

<p>If a single row was inserted, it will return the active record of the created object. Otherwise it will return the total entries inserted</p>

<p>For a single entry:</p>

<pre><code>$user = $users-&gt;insert(array(
                "name" =&gt; "Mardix",
                "age" =&gt; 30, 
                "city" =&gt; "Charlotte",
                "state" =&gt; "NC",
                "device" =&gt; "mobile",
                "timestamp" =&gt; $DB-&gt;NOW()
            ));
</code></pre>

<p>Returns the VoodOrm active record instance of this entry where you can use
<code>$user-&gt;name</code> or <code>$user-&gt;city</code>. We'll be able to do more later.</p>

<p>For a mass insert:</p>

<pre><code>$massInserts = $users-&gt;insert(array(
                    array(
                         "name" =&gt; "Mardix",
                         "city" =&gt; "Charlotte",
                         "state" =&gt; "NC",
                         "device" =&gt; "mobile",
                         "timestamp" =&gt; $DB-&gt;NOW()
                    ),
                    array(
                         "name" =&gt; "Cesar",
                         "city" =&gt; "Atlanta",
                         "state" =&gt; "GA",
                         "device" =&gt; "mobile",
                         "timestamp" =&gt; $DB-&gt;NOW()
                    ),
                    array(
                         "name" =&gt; "Gaga",
                         "city" =&gt; "Port-au-Prince",
                         "state" =&gt; "HT",
                         "device" =&gt; "computer",
                         "timestamp" =&gt; $DB-&gt;NOW()
                    ),
                ));
</code></pre>

<p>returns the total entries that were inserted</p>

<hr><h3>
<a name="mixed-voodormupdatearray-data" class="anchor" href="#mixed-voodormupdatearray-data"><span class="octicon octicon-link"></span></a><em>mixed</em> <strong><em>VoodOrm::update(Array $data)</em></strong>
</h3>

<p>There are two ways to update entries in VoodOrm, 1) by using the active record pattern for a fetched row, or 2) by using a where query to specify where to update. Also the method <code>VoodOrm::set($key, $value)</code> can be use to set the data before updating.</p>

<p><strong><em>For single entry</em></strong></p>

<pre><code>$user-&gt;update(array(
                    "city" =&gt; "Raleigh"
                ));
</code></pre>

<p>it's the same as</p>

<pre><code>$user-&gt;city = "Raleigh";
$user-&gt;update();
</code></pre>

<p>You can also use <code>save()</code> instead of <code>update()</code></p>

<pre><code>$user-&gt;save();
</code></pre>

<p>or with <em>Voodoo::set(Array $data) or Voodoo::set($key, $value)</em></p>

<pre><code>$user-&gt;set('city','Raleigh')-&gt;update();
</code></pre>

<p><strong><em>For multiple entries:</em></strong></p>

<p>For multiple entries we'll use <code>VoodOrm::set()</code> and <code>VoodOrm::where()</code> to specify where to update.</p>

<p><em>Voodoo::set(Array $data) or Voodoo::set($key, $value)</em></p>

<p>For mass update, we'll set the data to update using <code>set(Array $data)</code> and <code>where($k, $v)</code></p>

<pre><code>$user-&gt;set(array(
                "country_code" =&gt; "US"
        ))
        -&gt;where("device", "mobile")
        -&gt;update();
</code></pre>

<p>**There are more fluent <code>where</code> aliases under Fluent Query Interface*</p>

<hr><h3>
<a name="mixed-voodormsave" class="anchor" href="#mixed-voodormsave"><span class="octicon octicon-link"></span></a><em>mixed</em> <strong><em>VoodOrm::save()</em></strong>
</h3>

<p><code>Save()</code> is a shortcut to <code>VoodOrm::insert()</code> or <code>VoodOrm::update()</code></p>

<p>To insert new data:</p>

<pre><code>$user = $DB-&gt;users();
$user-&gt;name = "Mardix";
$user-&gt;city = "Charlotte";
$user-&gt;save(); 
</code></pre>

<p>To update:</p>

<pre><code>$user = $users-&gt;findOne(123456);
$user-&gt;city = "Atlanta";
$user-&gt;save();
</code></pre>

<hr><h3>
<a name="int-voodormdelete" class="anchor" href="#int-voodormdelete"><span class="octicon octicon-link"></span></a><em>int</em> <strong><em>VoodOrm::delete()</em></strong>
</h3>

<p>To delete entries we'll use the <code>VoodOrm::delete()</code> method</p>

<p>For single entries, by invoking the <code>delete()</code> method it will delete the current entry</p>

<pre><code>$user = $users-&gt;reset()-&gt;findOne(1234);
$user-&gt;delete();
</code></pre>

<p>For multiple entries, we will use the <code>VoodOrm::where()</code> method to specify where to delete</p>

<pre><code>$users-&gt;where("city", "Charlotte")-&gt;delete();
</code></pre>

<hr><h2>
<a name="aggregation" class="anchor" href="#aggregation"><span class="octicon octicon-link"></span></a>Aggregation</h2>

<p>VoodOrm gives you access to aggregation methods on your table</p>

<hr><h4>
<a name="int-voodormcount" class="anchor" href="#int-voodormcount"><span class="octicon octicon-link"></span></a><em>int</em> <strong><em>VoodOrm::count()</em></strong>
</h4>

<p>To count all the entries based on where clause</p>

<pre><code>$allUsers = $users-&gt;count();

$count = $voodorm-&gt;where($x, $y)-&gt;count();
</code></pre>

<p>or for a specific column name</p>

<pre><code>$count = $users-&gt;where($x, $y)-&gt;count($columnName);
</code></pre>

<h4>
<a name="float-voodormmax-string-columnname-" class="anchor" href="#float-voodormmax-string-columnname-"><span class="octicon octicon-link"></span></a><em>float</em> <strong><em>VoodOrm::max(</em></strong> <em>string $columnName</em> <strong><em>)</em></strong>
</h4>

<p>To get the max of a $columnName based on where() clause</p>

<pre><code>$max = $users-&gt;where($x, $y)-&gt;max($columnName);
</code></pre>

<h4>
<a name="float-voodormmin-string-columnname-" class="anchor" href="#float-voodormmin-string-columnname-"><span class="octicon octicon-link"></span></a><em>float</em> <strong><em>VoodOrm::min(</em></strong> <em>string $columnName</em> <strong><em>)</em></strong>
</h4>

<p>To get the min of a $columnName based on where() clause</p>

<pre><code>$min = $users-&gt;where($x, $y)-&gt;min($columnName);
</code></pre>

<h4>
<a name="float-voodormsum-string-columnname-" class="anchor" href="#float-voodormsum-string-columnname-"><span class="octicon octicon-link"></span></a><em>float</em> <strong><em>VoodOrm::sum(</em></strong> <em>string $columnName</em> <strong><em>)</em></strong>
</h4>

<p>To get the sum of a $columnName based on where() clause</p>

<pre><code>$sum = $users-&gt;where($x, $y)-&gt;sum($columnName);
</code></pre>

<h4>
<a name="float-voodormavg-string-columnname-" class="anchor" href="#float-voodormavg-string-columnname-"><span class="octicon octicon-link"></span></a><em>float</em> <strong><em>VoodOrm::avg(</em></strong> <em>string $columnName</em> <strong><em>)</em></strong>
</h4>

<p>To get the average of a $columnName based on where() clause</p>

<pre><code>$avg = $users-&gt;where($x, $y)-&gt;avg($columnName);
</code></pre>

<h4>
<a name="mixed-voodormaggregate-string-function-" class="anchor" href="#mixed-voodormaggregate-string-function-"><span class="octicon octicon-link"></span></a><em>mixed</em> <strong><em>VoodOrm::aggregate(</em></strong> <em>string $function</em> <strong><em>)</em></strong>
</h4>

<p>To run any aggregation function</p>

<pre><code>$agg = $users-&gt;where($x, $y)-&gt;aggregate('GROUP_CONCAT $columnName');
</code></pre>

<hr><h2>
<a name="querying" class="anchor" href="#querying"><span class="octicon octicon-link"></span></a>Querying</h2>

<p>VoodOrm provides a fluent interface to enable simple queries to be built without writing a single character of SQL. </p>

<p>Tow methods allow you to get a single entry or multiple entries: <code>findOne()</code> and <code>find()</code>. And <code>fromArray()</code> that load a raw data to the object. </p>

<hr><h2>
<a name="findone" class="anchor" href="#findone"><span class="octicon octicon-link"></span></a>FindOne</h2>

<h3>
<a name="voodorm-voodormfindone" class="anchor" href="#voodorm-voodormfindone"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::findOne()</em></strong>
</h3>

<p><code>findOne()</code> returns <code>VoodOrm</code> instance of a single entry if found, otherwise it will return <code>FALSE</code>.</p>

<pre><code>$user = $users-&gt;where('id', 1234)
              -&gt;findOne();
</code></pre>

<p>The primary key can be set in the <code>findOne(int $primaryKey)</code> to get the same result as the above query. Meaning no need to have a <code>where()</code> clause.</p>

<pre><code>$user = $users-&gt;findOne(1234);
</code></pre>

<p>Let's get the entry found:</p>

<pre><code>if ($user) {
    echo " Hello $user-&gt;name!";

// On a retrieved entry you can perform update and delete
    $user-&gt;last_viewed = $users-&gt;NOW();
    $suer-&gt;save();
}
</code></pre>

<hr><h2>
<a name="find" class="anchor" href="#find"><span class="octicon octicon-link"></span></a>Find</h2>

<h3>
<a name="arrayiterator-voodormfind" class="anchor" href="#arrayiterator-voodormfind"><span class="octicon octicon-link"></span></a><em>ArrayIterator</em> <strong><em>VoodOrm::find()</em></strong>
</h3>

<p><code>find()</code> returns an <code>ArrayIterator</code> of the rows found which are instances of <code>VoodOrm</code>, otherwise it will return <code>False</code>. </p>

<pre><code>$allUsers = $users-&gt;where('gender', 'male')
                  -&gt;find();

foreach ($allUsers as $user) {
    echo "{$user-&gt;name}";

// On a retrieved entry you can perform update and delete
    $user-&gt;last_viewed = $users-&gt;NOW();
    $user-&gt;save();
}
</code></pre>

<p><code>find()</code> also contains a shortcut when it's called in an iteration such as foreach:</p>

<pre><code>$allUsers = $users-&gt;where('gender', 'male');

foreach ($allUsers as $user) {
    echo "{$user-&gt;name}";

// On a retrieved entry you can perform update and delete
    $user-&gt;last_viewed = $users-&gt;NOW();
    $suer-&gt;save();
}
</code></pre>

<h3>
<a name="mixed-voodormfind-closure-callback-" class="anchor" href="#mixed-voodormfind-closure-callback-"><span class="octicon octicon-link"></span></a><em>mixed</em> <strong><em>VoodOrm::find(</em></strong> <em>Closure $callback</em> <strong><em>)</em></strong>
</h3>

<p><code>VoodOrm::find()</code> also accept a Closure as a callback to do your own data manipulation. Upon execution, VoodOrm will pass the data found from the query to the closure function.</p>

<pre><code>    $users-&gt;where('gender', 'male');

    $results = $users-&gt;find(function($data){
        $newResults = array();

        foreach ($data as $d) {
            $d["full_name"] = ucwords("{$data["first_name"]} {$data["last_name"]}");
            $newResults[] = $d;
        }

        return $newResults;
    }); 
</code></pre>

<hr><h2>
<a name="fromarray" class="anchor" href="#fromarray"><span class="octicon octicon-link"></span></a>FromArray</h2>

<h3>
<a name="voodorm-voodormfromarray-array-data-" class="anchor" href="#voodorm-voodormfromarray-array-data-"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::fromArray(</em></strong> <em>Array $data</em> <strong><em>)</em></strong>
</h3>

<p>Unlike <code>find()</code> and <code>findOne()</code> which make a query to the database to retrieve the data, <code>fromArray()</code> loads raw data and returns it as a VoodOrm object. It can be data that is cached into Redis/Memcached, but not coming directly from the database.</p>

<pre><code>$data = [
        "id" =&gt; 916,
        "name" =&gt; "Jose",
        "last_name" =&gt; "Martinez"
        ];

$anotherUser = $users-&gt;fromArray($data);
</code></pre>

<p>Now you can operate on it</p>

<pre><code>$anotherUse-&gt;update(
                    ["name" =&gt; "Yolo"]
                );
</code></pre>

<hr><h2>
<a name="fluent-query-builder" class="anchor" href="#fluent-query-builder"><span class="octicon octicon-link"></span></a>Fluent Query Builder</h2>

<hr><h2>
<a name="select" class="anchor" href="#select"><span class="octicon octicon-link"></span></a>Select</h2>

<h3>
<a name="voodorm-voodormselect-columns----" class="anchor" href="#voodorm-voodormselect-columns----"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::select(</em></strong> <em>$columns = '\</em>'*  <strong><em>)</em></strong>
</h3>

<p>To select the fields in the table. If ommitted, VoodOrm will fetch all the columns.</p>

<pre><code>$users-&gt;select()
</code></pre>

<p>or with selected columns</p>

<pre><code>$users-&gt;select("name, age")
        -&gt;select("last_viewed");

&gt; SELECT name, age, last_viewed
</code></pre>

<hr><h2>
<a name="where" class="anchor" href="#where"><span class="octicon octicon-link"></span></a>Where</h2>

<p><code>Where</code> allow you to set where clauses for the query. Below you will find many aliases for <code>where</code></p>

<p><code>Where</code> clauses work with VoodOrm::find()<code>,</code>VoodOrm::findOne()<code>,</code>VoodOrm::update()<code>and</code>VoodOrm::delete()`</p>

<p>Repetitive call of <code>where</code> or any <code>where</code> aliases will append the where clause to the previous where by using the AND operator. To use the OR operator instead you must call to <code>VoodOrm::_or()</code>. More below.</p>

<h3>
<a name="voodorm-voodormwhere-condition-parameters--array--" class="anchor" href="#voodorm-voodormwhere-condition-parameters--array--"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::where(</em></strong> <em>$condition $parameters = array()</em>  <strong><em>)</em></strong>
</h3>

<p>This is the main <code>where</code>. It is responsible for all the wheres.</p>

<p><code>$condition</code> is the condition to use. It can contain ? or :name which is bound by PDO to <code>$parameters</code> (so no manual escaping is required).</p>

<p><code>$parameters</code> is the value(s) to bind to the condition. It can be one array, one associative array or zero or more scalars. </p>

<p>Som examples</p>

<pre><code>$users-&gt;where("name", "Mardix");
WHERE name = ?

$users-&gt;where("age &gt; ?", 25);
WHERE age &gt; ?

$users-&gt;where("name in (?, ?, ?)", "Mike", "Jones", "Rich");
WHERE name IN (?, ?, ?)

$users-&gt;where("(field1, field2)", array(array(1, 2), array(3, 4)))
WHERE (field1, field2) IN ((?, ?), (?, ?))
</code></pre>

<p>But to facilitate the task, VoodOrm comes with some aliases for common operation:</p>

<h3>
<a name="voodorm-voodormwherepk-int-primarykey--" class="anchor" href="#voodorm-voodormwherepk-int-primarykey--"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::wherePK(</em></strong> <em>int $primaryKey</em>  <strong><em>)</em></strong>
</h3>

<p>Where the primary key is set
    $users-&gt;wherePK(1234);</p>

<h3>
<a name="voodorm-voodormwherenot-columnname-value--" class="anchor" href="#voodorm-voodormwherenot-columnname-value--"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::whereNot(</em></strong> <em>$columnName, $value</em>  <strong><em>)</em></strong>
</h3>

<pre><code>$users-&gt;whereNot('age', 24);

WHERE age != ?
</code></pre>

<h3>
<a name="voodorm-voodormwherelike-columnname-value--" class="anchor" href="#voodorm-voodormwherelike-columnname-value--"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::whereLike(</em></strong> <em>$columnName, $value</em>  <strong><em>)</em></strong>
</h3>

<pre><code>$users-&gt;whereLike('name', 'w%');

WHERE name LIKE ?
</code></pre>

<h3>
<a name="voodorm-voodormwherenotlike-columnname-value--" class="anchor" href="#voodorm-voodormwherenotlike-columnname-value--"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::whereNotLike(</em></strong> <em>$columnName, $value</em>  <strong><em>)</em></strong>
</h3>

<pre><code>$users-&gt;whereNotLike('name', 'r%');

WHERE name NOT LIKE ?
</code></pre>

<h3>
<a name="voodorm-voodormwheregt-columnname-value--" class="anchor" href="#voodorm-voodormwheregt-columnname-value--"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::whereGt(</em></strong> <em>$columnName, $value</em>  <strong><em>)</em></strong>
</h3>

<pre><code>$users-&gt;whereGt('age', 21);

WHERE age &gt; ?
</code></pre>

<h3>
<a name="voodorm-voodormwheregte-columnname-value--" class="anchor" href="#voodorm-voodormwheregte-columnname-value--"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::whereGte(</em></strong> <em>$columnName, $value</em>  <strong><em>)</em></strong>
</h3>

<pre><code>$users-&gt;whereGte('age', 21);

WHERE age &gt;= ?
</code></pre>

<h3>
<a name="voodorm-voodormwherelt-columnname-value--" class="anchor" href="#voodorm-voodormwherelt-columnname-value--"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::whereLt(</em></strong> <em>$columnName, $value</em>  <strong><em>)</em></strong>
</h3>

<pre><code>$users-&gt;whereLt('age', 21);

WHERE age &lt; ?
</code></pre>

<h3>
<a name="voodorm-voodormwherelte-columnname-value--" class="anchor" href="#voodorm-voodormwherelte-columnname-value--"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::whereLte(</em></strong> <em>$columnName, $value</em>  <strong><em>)</em></strong>
</h3>

<pre><code>$users-&gt;whereLte('age', 21);

WHERE age &lt;= ?
</code></pre>

<h3>
<a name="voodorm-voodormwherein-columnname-array-value--" class="anchor" href="#voodorm-voodormwherein-columnname-array-value--"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::whereIn(</em></strong> <em>$columnName, Array $value</em>  <strong><em>)</em></strong>
</h3>

<pre><code>$users-&gt;whereIn('city', array('Charlotte', 'Atlanta'));

WHERE city IN (?,?)
</code></pre>

<h3>
<a name="voodorm-voodormwherenotin-columnname-array-value--" class="anchor" href="#voodorm-voodormwherenotin-columnname-array-value--"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::whereNotIn(</em></strong> <em>$columnName, Array $value</em>  <strong><em>)</em></strong>
</h3>

<pre><code>$users-&gt;whereNotIn('city', array('Chicago', 'Miami'));

WHERE city NOT IN (?,?)
</code></pre>

<h3>
<a name="voodorm-voodormwherenull-columnname--" class="anchor" href="#voodorm-voodormwherenull-columnname--"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::whereNull(</em></strong> <em>$columnName</em>  <strong><em>)</em></strong>
</h3>

<pre><code>$users-&gt;whereNull('city');

WHERE city IS NULL
</code></pre>

<h3>
<a name="voodorm-voodormwherenotnull-columnname--" class="anchor" href="#voodorm-voodormwherenotnull-columnname--"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::whereNotNull(</em></strong> <em>$columnName</em>  <strong><em>)</em></strong>
</h3>

<pre><code>$users-&gt;whereNotNull('name');

WHERE city NOT NULL
</code></pre>

<hr><h2>
<a name="where-with-or-and-and" class="anchor" href="#where-with-or-and-and"><span class="octicon octicon-link"></span></a>Where with OR and AND</h2>

<p>Building your query, you will want to add AND and OR operator in your where clause. To do so, use <code>VoodOrm::_and()</code> and <code>VoodOrm::_or()</code> chained to any <code>where</code> aliases</p>

<h3>
<a name="voodorm-voodorm_and" class="anchor" href="#voodorm-voodorm_and"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::_and()</em></strong>
</h3>

<p>To add the <code>AND</code> operator in a where query. <code>AND</code> is set by default, if not <code>_and()</code> is not called, VoodOrm will add it by default. </p>

<pre><code>$users-&gt;where("city", "Charlotte")-&gt;_and()-&gt;whereGte("age", 21);

WHERE city = ? AND age &gt;= ?
</code></pre>

<h3>
<a name="voodorm-voodorm_or" class="anchor" href="#voodorm-voodorm_or"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::_or()</em></strong>
</h3>

<p>To add the <code>OR</code> operator in a where query.</p>

<pre><code>$users-&gt;where("city", "Charlotte")-&gt;_or()-&gt;whereGte("age", 21)-&gt;_or()-&gt;where("gender", "female");

WHERE city = ? OR age &gt;= ? OR gender = ?
</code></pre>

<hr><h2>
<a name="where-with-wrap" class="anchor" href="#where-with-wrap"><span class="octicon octicon-link"></span></a>Where with Wrap()</h2>

<p>When building quasi complicated query with multiple set of where, <code>VoodOrm::wrap()</code> group the where together in parenthesis. </p>

<h3>
<a name="voodorm-voodormwrap" class="anchor" href="#voodorm-voodormwrap"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::wrap()</em></strong>
</h3>

<pre><code>$users-&gt;where("city", "Charlotte")-&gt;whereGte("age", 21)-&gt;wrap()
      -&gt;where("gender", "female")-&gt;where("city", "Atlanta");

WHERE (city = ? AND age &gt;= ?) AND (gender = ? AND city = ?)
</code></pre>

<h3>
<a name="voodorm-voodormwrap-_and" class="anchor" href="#voodorm-voodormwrap-_and"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::wrap()-&gt;_and()</em></strong>
</h3>

<p><code>wrap()-&gt;_and()</code> does a union with another grouped where with the <code>AND</code> operator.</p>

<pre><code>$users-&gt;where("city", "Charlotte")-&gt;whereGte("age", 21)-&gt;wrap()-&gt;_and()
      -&gt;where("gender", "female")-&gt;where("city", "Atlanta");

WHERE (city = ? AND age &gt;= ?) AND (gender = ? AND city = ?)
</code></pre>

<h3>
<a name="voodorm-voodormwrap-_or" class="anchor" href="#voodorm-voodormwrap-_or"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::wrap()-&gt;_or()</em></strong>
</h3>

<p><code>wrap()-&gt;_or()</code> does a union with another grouped where with the <code>OR</code> operator.</p>

<pre><code>$users-&gt;where("city", "Charlotte")-&gt;whereGte("age", 21)-&gt;wrap()-&gt;_or()
      -&gt;where("gender", "female")-&gt;where("city", "Atlanta");

WHERE (city = ? AND age &gt;= ?) OR (gender = ? AND city = ?)
</code></pre>

<h4>
<a name="wrap-_and-and-wrap-_or-in-the-same-query" class="anchor" href="#wrap-_and-and-wrap-_or-in-the-same-query"><span class="octicon octicon-link"></span></a>wrap()-&gt;_and() and wrap()-&gt;_or() in the same query</h4>

<pre><code>$users-&gt;where("id",1)-&gt;where("city","charlotte")-&gt;wrap()
      -&gt;where("gender","female")-&gt;where("country","US")-&gt;wrap()
      -&gt;_or()-&gt;where("city",array("Charlotte","Atlanta"))-&gt;wrap()
      -&gt;_or()-&gt;whereLt('age',21)-&gt;whereGte("name","Mardix")-&gt;wrap();

WHERE (id = ? AND city = ?) 
      AND (gender = ? AND country = ?) 
      OR ((city IN (?, ?))) 
      OR (age &lt; ? AND name &gt;= ?) 
</code></pre>

<hr><h2>
<a name="order-group-limit-offset" class="anchor" href="#order-group-limit-offset"><span class="octicon octicon-link"></span></a>Order, Group, Limit, Offset</h2>

<h3>
<a name="voodorm-voodormorderby-columnname-ordering--" class="anchor" href="#voodorm-voodormorderby-columnname-ordering--"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::orderBy(</em></strong> <em>$columnName, $ordering</em>  <strong><em>)</em></strong>
</h3>

<pre><code>$users-&gt;orderBy('name', 'DESC');

ORDER BY name DESC
</code></pre>

<h3>
<a name="voodorm-voodormgroupby-columnname--" class="anchor" href="#voodorm-voodormgroupby-columnname--"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::groupBy(</em></strong> <em>$columnName</em>  <strong><em>)</em></strong>
</h3>

<pre><code>$users-&gt;groupBy('city');

GROUP BY city
</code></pre>

<h3>
<a name="voodorm-voodormlimit-int-limit--" class="anchor" href="#voodorm-voodormlimit-int-limit--"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::limit(</em></strong> <em>int $limit</em>  <strong><em>)</em></strong>
</h3>

<pre><code>$users-&gt;limit(10);

LIMIT 10
</code></pre>

<h3>
<a name="voodorm-voodormoffset-int-offset--" class="anchor" href="#voodorm-voodormoffset-int-offset--"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::offset(</em></strong> <em>int $offset</em>  <strong><em>)</em></strong>
</h3>

<pre><code>$users-&gt;offset(10);

OFFSET 10
</code></pre>

<hr><h2>
<a name="joins" class="anchor" href="#joins"><span class="octicon octicon-link"></span></a>Joins</h2>

<h3>
<a name="voodorm-voodormjoin-tablename-constraint-table_alias--join_operator-" class="anchor" href="#voodorm-voodormjoin-tablename-constraint-table_alias--join_operator-"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::join(</em></strong> <em>$tablename, $constraint, $table_alias , $join_operator</em> <strong><em>)</em></strong>
</h3>

<pre><code>$users-&gt;join('friends', 'f.user_id = u.id', 'f')

JOIN friends AS f ON f.user_id = u.id
</code></pre>

<h3>
<a name="voodorm-voodormleftjoin-tablename-constraint-table_alias-" class="anchor" href="#voodorm-voodormleftjoin-tablename-constraint-table_alias-"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::leftJoin(</em></strong> <em>$tablename, $constraint, $table_alias</em> <strong><em>)</em></strong>
</h3>

<pre><code>$users-&gt;leftJoin('friends', 'f.user_id = u.id', 'f')

LEFT JOIN friends AS f ON f.user_id = u.id
</code></pre>

<hr><h2>
<a name="relationship" class="anchor" href="#relationship"><span class="octicon octicon-link"></span></a>Relationship</h2>

<p>That's the killer!</p>

<p>One of VoodOrm killer feature is Relationship. By calling a table as a method on an object automatically creates a One To Many relationship on that reference table by default.</p>

<p>For this example we'll have two tables: <code>user</code> (id, name, dob) and <code>friend</code> (id, user_id, friend_id)</p>

<p>The <code>friend.user_id</code> is the foreign key to the <code>user</code> table. And <code>friend.friend_id</code> is the foreign key of the friend's <code>user.id</code>.</p>

<p>Let's get all the users and their friends</p>

<pre><code>$allUsers = $users-&gt;find();

foreach ($allUsers as $user) {
    /**
    * Connect to the 'friend' table = $user-&gt;friend();
    * In the back, it does a ONE To MANY relationship 
    * SELECT * FROM friend WHERE friend.user_id = user.id 
    */
    $allFriends = $user-&gt;friend();
    foreach ($allFriends as $friend) {
        echo "{$friend-&gt;friend_id} : ";

        /**
        * We got the friend's entry, we want to go back in the user table
        * So we link back the friend table to the user table
        * SELECT * FROM user WHERE user.id = friend.friend_id LIMIT 1 
        * It will do a ONE to One relationship
        */
        echo $friend-&gt;user(Voodoo\VoodOrm::REL_HASONE, "friend_id")-&gt;name;

        echo "\n";
    }
}

// Same as above but with just one user
$user = $users-&gt;findOne($userId);
if($user) {

    foreach ($user-&gt;friend() as $friend) {

        echo "{$friend-&gt;friend_id} : ";

        echo $friend-&gt;user(Voodoo\VoodOrm::REL_HASONE, "friend_id")-&gt;name;

        echo "\n";
    }
}
</code></pre>

<p>That's the big picture. Calling a reference table as a method on a object will do a relationship. </p>

<h2>
<a name="relationship-one-to-many" class="anchor" href="#relationship-one-to-many"><span class="octicon octicon-link"></span></a>Relationship: <em>One to Many</em>
</h2>

<p>One to many relationship, in our user and friend case, it's where a user can have one or more friends. But each <code>friend.friend_id</code> is associated to one <code>user.id</code>. This type of relationship will return one or more entries. </p>

<p>The relationship between <code>user</code> (single-valued) and <code>friend</code> (multi-valued) is a one-to-many relationship. </p>

<p>In our above example, we did a One to Many relationship in the friend's table</p>

<pre><code>$allFriends = $user-&gt;friend();
</code></pre>

<p>Relationship Constants</p>

<p>VoodOrm has pre-defined constant that let you select execute a type of relationship</p>

<p><em>CONST::REL_HASMANY (2)</em></p>

<pre><code>$allFriends = $user-&gt;friend(Voodoo\VoodOrm::REL_HASMANY);
</code></pre>

<p>This is faster. It does an eager loading by fetching all the data and hold the data in memory. It executes only one query. It is used by default.</p>

<p><em>CONST::REL_LAZYMANY (-2)</em></p>

<pre><code>$allFriends = $user-&gt;friend(Voodoo\VoodOrm::REL_LAZYMANY);
</code></pre>

<p>This is slower. It does a lazy loading by fetching the data as it's being requested. It will execute 1+N queries.</p>

<h2>
<a name="relationship-one-to-one" class="anchor" href="#relationship-one-to-one"><span class="octicon octicon-link"></span></a>Relationship: <em>One to One</em>
</h2>

<p>One-to-one relationships are single-valued in both directions. In the friend's table, <code>friend.friend_id</code> is linked to <code>user.id</code>  </p>

<pre><code>$allFriends = $user-&gt;friend();
</code></pre>

<p>Relationship Constants</p>

<p><em>CONST::REL_HASONE (1)</em></p>

<pre><code>$friendUser = $friend-&gt;user(Voodoo\Core\VoodOrm::REL_HASONE, "friend_id");
echo $friendUser-&gt;name;
</code></pre>

<p>It does an eager loading by fetching all the data and hold the data in memory. It executes only one query. It is used by default.</p>

<p><em>CONST::REL_LAZYONE (-1)</em></p>

<pre><code>$friendUser = $friend-&gt;user(Voodoo\VoodOrm::REL_LAZYONE, "friend_id");
echo $friendUser-&gt;name;
</code></pre>

<p>This is slower. It does a lazy loading by fetching the data as it's being requested. It will execute 1+N queries.</p>

<h4>
<a name="relationship-many-to-many" class="anchor" href="#relationship-many-to-many"><span class="octicon octicon-link"></span></a>Relationship: <em>Many to Many</em>
</h4>

<p>Not implemented. That shit is complicated.... can't find a one case fit all... </p>

<h2>
<a name="relationship-parameters" class="anchor" href="#relationship-parameters"><span class="octicon octicon-link"></span></a>Relationship Parameters</h2>

<p>VoodOrm relationship accept 4 types of parameters that can be placed anywhere:</p>

<pre><code>$user-&gt;friend(NUMBER, STRING, ARRAY, CALLBACK);
</code></pre>

<p><strong>NUMBER</strong> : Usually that's the relationship constants <code>REL_HASONE = 1</code>, <code>REL_LAZYONE = -1</code>, <code>RE_HASMANY = 2</code>, <code>REL_LAZYMANY = -2</code>;</p>

<pre><code>$user-&gt;friend(Voodoo\VoodOrm::REL_HASMANY);
</code></pre>

<p><strong>STRING</strong>: Having a tring as an argument will be used as a foreign key name</p>

<pre><code>$user-&gt;friend("friend_id");
</code></pre>

<p><strong>ARRAY</strong> : Array will be used as a WHERE condition. Array must be a key/value matching the fields in the table</p>

<pre><code>$user-&gt;friend(array(
    "friendship_start_time &gt;= " =&gt; date("Y-m-d")
));
</code></pre>

<p><strong>CALLBACK</strong>: Callback is a function to run on the results</p>

<pre><code>$user-&gt;friend(function($data){

    $tableData = array();

    foreach($data as $d) {
        $tableData[] = array_merge(
                            $data,
                            array("visits_count"=&gt;$d[visits_count] + 1)
                        ); 
    }
    return $tableData;
}); 
</code></pre>

<p>Now do the Pot Pourri!</p>

<pre><code>$user-&gt;friend(Voodoo\VoodOrm::REL_HASONE, 

                "friend_id", 

                array("friendship_start_time &gt;= " =&gt; date("Y-m-d"),

                function($data){

                        $tableData = array();

                        foreach($data as $d) {
                            $tableData[] = array_merge(
                                                $data,
                                                array("visits_count"=&gt;$d[visits_count] + 1)
                                            ); 
                        }
                        return $tableData;
                    }           
));



$user-&gt;friend(NUMBER, STRING, ARRAY, CALLBACK);
</code></pre>

<hr><h2>
<a name="table-structure" class="anchor" href="#table-structure"><span class="octicon octicon-link"></span></a>Table Structure</h2>

<p>Table structure allows to define the table structure in the database. It is set on the constructor</p>

<pre><code>new VoodOrm($PDO, $primaryKey = 'id', $foreignKey = '%s_id')
</code></pre>

<p>PRIMARYKEY : by default is set to <code>id</code> but can be anything</p>

<p>FOREIGNKEY : Is the foreign key. By default it is set %s_id where %s is the table name. So a table user, in a friend table the foreign key will be <code>user_id</code></p>

<p>You can also use <code>setStructure($primaryKey, $foreignKey)</code> to set the structure.</p>

<pre><code>$DB = new VoodOrm($PDO);
$DB-&gt;setStructure("id", "%s_id");
</code></pre>

<p><strong>It is important that a table structure is set, so VoodOrm can identify the primary and foreign keys for relationship.</strong></p>

<hr><h2>
<a name="other-methods" class="anchor" href="#other-methods"><span class="octicon octicon-link"></span></a>Other Methods</h2>

<p>With the code below:</p>

<p>$users = $DB-&gt;table('users');</p>

<h4>
<a name="string-voodormgetprimarykeyname" class="anchor" href="#string-voodormgetprimarykeyname"><span class="octicon octicon-link"></span></a><em>string</em> <strong><em>VoodOrm::getPrimaryKeyName()</em></strong>
</h4>

<pre><code>$users-&gt;getPrimaryKeyName();
</code></pre>

<p>Return the primary key name. Most of the time it will be <code>id</code></p>

<h4>
<a name="string-voodormgetforeignkeyname" class="anchor" href="#string-voodormgetforeignkeyname"><span class="octicon octicon-link"></span></a><em>string</em> <strong><em>VoodOrm::getForeignKeyName()</em></strong>
</h4>

<pre><code>$users-&gt;getForeignKeyName();
</code></pre>

<p>Return the foreign key name. Based on the table stucture above, it will be <code>user_id</code></p>

<h3>
<a name="string-voodormgettablename" class="anchor" href="#string-voodormgettablename"><span class="octicon octicon-link"></span></a><em>string</em> <strong><em>VoodOrm::getTableName()</em></strong>
</h3>

<p>Returns the table name</p>

<pre><code>$tableName = $users-&gt;getTableName();
</code></pre>

<h3>
<a name="voodorm-voodormtablealias-string-alias-" class="anchor" href="#voodorm-voodormtablealias-string-alias-"><span class="octicon octicon-link"></span></a><em>VoodOrm</em> <strong><em>VoodOrm::tableAlias(</em></strong> <em>string $alias</em> <strong><em>)</em></strong>
</h3>

<p>To set a name as alias of the table</p>

<pre><code>$users-&gt;tableAlias("user");
</code></pre>

<h3>
<a name="string-voodormgettablealias" class="anchor" href="#string-voodormgettablealias"><span class="octicon octicon-link"></span></a><em>string</em> <strong><em>VoodOrm::getTableAlias()</em></strong>
</h3>

<p>Returns the table alias name</p>

<pre><code>$alias = $users-&gt;getTableAlias();
</code></pre>

<h3>
<a name="array-voodormgetstructure" class="anchor" href="#array-voodormgetstructure"><span class="octicon octicon-link"></span></a><em>Array</em> <strong><em>VoodOrm::getStructure()</em></strong>
</h3>

<p>Return the structure that was set</p>

<pre><code>$structure = $users-&gt;getStructure();
</code></pre>

<h3>
<a name="bool-voodormissinglerow" class="anchor" href="#bool-voodormissinglerow"><span class="octicon octicon-link"></span></a><em>Bool</em> <strong><em>VoodOrm::isSingleRow()</em></strong>
</h3>

<p>Return true or false if an entry is a single row</p>

<pre><code>$user = $users-&gt;findOne(123);

if ($user-&gt;isSingleRow()) {
    // do something here
}
</code></pre>

<h3>
<a name="string-voodormnow" class="anchor" href="#string-voodormnow"><span class="octicon octicon-link"></span></a><em>String</em> <strong><em>VoodOrm::NOW()</em></strong>
</h3>

<p>It returns the current DateTime: Y-M-D H:i:s</p>

<hr><h2>
<a name="extends-voodorm-to-your-model" class="anchor" href="#extends-voodorm-to-your-model"><span class="octicon octicon-link"></span></a>Extends VoodOrm to your Model</h2>

<p>This is an example below on how you can setup your models with VoodOrm in real world applications. We'll setup the models, and have a controller retrieve them based on an MVC application. The application is base on <a href="http://github.com/mardix/Voodoo">Voodoo</a>, a slim Modular MVC framework in PHP.</p>

<p><strong>Lib/Model/BaseModel.php:</strong> </p>

<p><em>The base model contains the connection to the DB, and extra methods can be added. BaseModel will be extended in the model classes</em></p>

<pre><code>&lt;?php

namespace Model;

use Voodoo;

abstract class BaseModel extends Voodoo\VoodOrm
{
    private static $pdo = null;

    // setup the DB connection
    public function __construct()
    {
        if (! self::$pdo) {
            self::$pdo = new PDO("mysql:host=localhost;dbname=$dbname", $username, $password);
            self::$pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);                
        }

        parent::__construct(self::$pdo);
        $instance = parent::table($this-&gt;tableName);
        $this-&gt;table_name = $instance-&gt;getTablename();          
    }
}
</code></pre>

<p><strong>Lib/Model/Diskoteka/Artist.php</strong></p>

<pre><code>&lt;?php

namespace Model\Diskoteka;

use Lib\Model;

class Artist extends Model\BaseModel
{
    protected $tableName = "artist";

    // We concat the first and last name
    public function getName()
    {
        return $this-&gt;first_name." ".$this-&gt;last_name; 
    }
}
</code></pre>

<p><strong>Lib/Model/Diskoteka/Album.php</strong></p>

<pre><code>&lt;?php

namespace Model\Diskoteka;

use Lib\Model;

class Album extends Model\BaseModel
{
    protected $tableName = "album";

    // Returns the VoodOrm object to do more in the query
    public function getSongs()
    {
        return (new Song)-&gt;where("album_id", $this-&gt;getPK());
    }
}
</code></pre>

<p><strong>Lib/Model/Diskoteka/Song.php</strong></p>

<pre><code>&lt;?php

namespace Model\Diskoteka;

use Lib\Model,
    Closure;

class Song extends Model\BaseModel
{
    protected $tableName = "song";

    public function getArtistName()
    {
        return $this-&gt;artist_first_name;
    }

    public function getAlbumTitle()
    {
        return $this-&gt;album_title;
    }

    // We modify the find() to join this table to album and artist tables
    public function find(Closure $callback = null) 
    {
        $this-&gt;tableAlias("song")
            -&gt;select("song.*")
            -&gt;select("album.title As album_title")
            -&gt;select("artist.first_name AS artist_first_name")
            -&gt;leftJoin(new Artist, "artist.id = song.artist_id", "artist")
            -&gt;leftJoin(new Album, "album.id = song.album_id", "album");

        retun parent::find($callback);
    }
}
</code></pre>

<p><strong>App/Www/Main/Controller/Index.php</strong></p>

<p><em>Using <a href="http://github.com/mardix/Voodoo">Voodoo</a>, we'll create a controller to use the models</em></p>

<pre><code>&lt;?php

namespace App\Www\Main\Controller;

use Voodoo,
    Lib\Model\Diskoteka;

class Index extends Voodoo\Core\Controller
{
    /**
     * List all songs, which will include the the artist name and album name
     * http://the-url/
     */
    public function actionIndex()
    {
        $allSongs = (new Diskoteka\Song);
        $allSongs-&gt;orderBy("title", "ASC");

        $songs = [];
        foreach ($allSongs as $song) {
            $songs[] = [
                "id" =&gt; $song-&gt;getPK()
                "title" =&gt; $song-&gt;title,
                "albumTitle" =&gt; $song-&gt;getAlbumTitle(),
                "artistName" =&gt; $song-&gt;getArtistName()
            ];              
        }
        $this-&gt;view()-&gt;assign("songs", $songs);
    }

    /**
     * Simply get the Artist info
     * http://the-url/artist/59
     */
    public function actionArtist()
    {
        $id = $this-&gt;getSegment(1); // -&gt; 59
        $artist = (new Diskoteka\Artist)-&gt;findOne($id); 
        $countAlbums = (new Diskoteka\Album)
                                    -&gt;where("artist_id", $id)
                                    -&gt;count();

        $this-&gt;view()-&gt;assign([
            "name" =&gt; $artist-&gt;getName(),
            "countAlbums" =&gt; $countAlbums
        ]); 
    }


    /**
     * Get the song info, with album basic info
     * http://the-url/song/1637
     */
    public function actionSong()
    {
        $id = $this-&gt;getSegment(1); // -&gt; 1637
        $song = (new Diskoteka\Song)-&gt;findOne($id);

        if ($song) {
            $this-&gt;view()-&gt;assign([
                "id" =&gt; $song-&gt;getPK()
                "title" =&gt; $song-&gt;title,
                "albumTitle" =&gt; $song-&gt;getAlbumTitle(),
                "artistName" =&gt; $song-&gt;getArtistName()
            ]);
        }
    }

    /**
     * Get the album info including all songs
     * http://your-url.com/album/437
     */
    public function actionAlbum()
    {
        $id = $this-&gt;getSegment(1);
        $album = (new Diskoteka\Album)-&gt;findOne($id);

        $allSongs = $album-&gt;getSongs();
        $albumSongs = [];
        foreach ($allSongs as $song) {
            $albumSongs[] = [
                "id" =&gt; $song-&gt;getPK(),
                "title" =&gt; $song-&gt;title
            ];
        }
        $this-&gt;view()-&gt;assign([
            "album" =&gt; [
                "id" =&gt; $album-&gt;getPK(),
                "title" =&gt; $album-&gt;title
            ],
            "songs" =&gt; $albumSongs
        ]);
    }

}
</code></pre>

<hr><p>Contributers </p>

<p>Thank you for your interest in VoodOrm. </p>

<p>If you would like to contribute, please do a pull request.</p>

<p>VoodOrm follows closely PSR-2</p>

<hr><p>(c) This Year Mardix :) </p>
        </section>

        <footer>
          VoodOrm 2.x.x is maintained by <a href="https://github.com/mardix">mardix</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="http://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>